
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RRS Discovery (1901-4) &#8212; Weather observations from marine expeditions</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scotia (1902-4)" href="Scotia_1902-4.html" />
    <link rel="prev" title="Southern Cross (1897-1900)" href="Southern_Cross_1897-1900.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Scotia_1902-4.html" title="Scotia (1902-4)"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="Southern_Cross_1897-1900.html" title="Southern Cross (1897-1900)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Expeditions</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Antarctic.html" accesskey="U">Antarctic Expeditions</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/The_Water_Bucket_by_Carroll_Jones_III.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../instructions.html">How to use this dataset</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Cook.html">James Cook’s Expeditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arctic.html">Arctic Expeditions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Antarctic.html">Antarctic Expeditions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Belgica_1897-99.html">Belgica (1897-99)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Southern_Cross_1897-1900.html">Southern Cross (1897-1900)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RRS Discovery (1901-4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Scotia_1902-4.html">Scotia (1902-4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Francais_1904.html">Francais (1904)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Nimrod_1907-9.html">Nimrod (1907-9)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Porquoi_pas_1908-10.html">Porquoi Pas (1908-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Terra_Nova_1910-13.html">Terra Nova (1910-13)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Aurora_1911-14.html">Aurora (1911-14)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Imperial_trans_antarctic.html">Imperial Trans-Antarctic Expedition (1914-17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Discovery_1929-31.html">RRS Discovery (1929-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bear_1939-40.html">USS Bear (1939-40)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Other.html">Other Expeditions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ToDo/ToDo.html">Expeditions To Do</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uses.html">Uses of this data</a></li>
</ul>
<h3><a href="https://github.com/oldweather/Expeditions">Get the data</a></h3>

<ul>
<li><a href="https://github.com/oldweather/Expeditions"
           rel="nofollow">Github repository</a></li>
<li><a href="https://github.com/oldweather/Expeditions/archive/master.zip"
           rel="nofollow">Zip file</a></li>
</ul>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/oldweather/Expeditions/issues/new">raise an issue</a>.
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rrs-discovery-1901-4">
<h1>RRS Discovery (1901-4)<a class="headerlink" href="#rrs-discovery-1901-4" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/RRS_Discovery">RRS Discovery</a> was the ship, and main base, of the <a class="reference external" href="https://en.wikipedia.org/wiki/Discovery_Expedition">British National Antarctic Expedition</a>, commanded by <a class="reference external" href="https://en.wikipedia.org/wiki/Robert_Falcon_Scott">Robert Falcon Scott</a>.</p>
<p>The expedition reports included exerpts from the Meteorological log of the Discovery (though only for the period when she was frozen into Winter Quarters Bay). These are the observations included here.</p>
<div class="section" id="transcribed-observations">
<h2>Transcribed observations<a class="headerlink" href="#transcribed-observations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/oldweather/Expeditions/blob/master/voyages/discovery_1901-4/as_digitised/DISCOVERY.xls">Excel spreadsheet</a></li>
<li><a class="reference external" href="https://github.com/oldweather/Expeditions/blob/master/voyages/discovery_1901-4/as_digitised/DISCOVERY.txt">CSV file</a></li>
</ul>
</div>
<div class="section" id="conversion-script">
<h2>Conversion script<a class="headerlink" href="#conversion-script" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/usr/bin/perl

# Brocess digitised logbook data from The Discovery into
#  IMMA records.

use strict;
use warnings;
use lib &quot;/home/hc1300/hadpb/tasks/digitisation/imma/&quot;;
use IMMA;
use Getopt::Long;
use FindBin;

my $Ship_name = &#39;Discovery&#39;;
my ( $Year, $Month, $Day );
my $isMorning = 1;

while (&lt;&gt;) {
    my @Fields = split /\t/, $_;
    unless ( $Fields[2] =~ /^\d+$/ ) {
        next;
    }    # Discard all coment and mean lines
    my $Ob = new IMMA;
    $Ob-&gt;clear();    # Why is this necessary?
    push @{ $Ob-&gt;{attachments} }, 0;

    # Position always fixed - frozen in the ice
    $Ob-&gt;{LAT} = -77.83;    # Set to position of Hut Point
    $Ob-&gt;{LON} = 166.38;
    $Ob-&gt;{LI}  = 6;         # Position from Metadata
                            # Get the date if available
    if ( defined( $Fields[0] ) &amp;&amp; $Fields[0] =~ /(\d\d\d\d) (\d+)/ ) {
        $Year  = $1;
        $Month = $2;
    }
    elsif ( defined( $Fields[0] ) &amp;&amp; $Fields[0] =~ /\d/ ) {
        $Year = $Fields[0];
    }
    if ( defined( $Fields[1] ) &amp;&amp; $Fields[1] =~ /\d/ ) { $Day = $Fields[1]; }

    # Set the Date/Time fields and correct for Longitude
    my $Hour = $Fields[2];
    if ( $isMorning != 1 ) {    # afternoon
        if ( $Hour != 24 ) { $Hour += 12; }
        else { $isMorning = 1; }    # Morning henceforth
    }
    else {                          # Morning
        if ( $Hour == 12 ) { $isMorning = 0; }
    }
    $Ob-&gt;{YR} = $Year;
    $Ob-&gt;{MO} = $Month;
    $Ob-&gt;{DY} = $Day;
    $Ob-&gt;{HR} = $Hour;
    correct_hour_for_lon($Ob);

    # Pressure converted from inches
    if ( defined( $Fields[3] )
        &amp;&amp; $Fields[3] =~ /\S/ )
    {
        my $Value = $Fields[3];
        $Value =~ s/[^\d+\-.]//g;
        if ( $Value =~ /\d/ ) {
            $Ob-&gt;{SLP} = $Value * 33.86;
        }
    }

    # Temperatures converted from Farenheit
    if ( defined( $Fields[6] )
        &amp;&amp; $Fields[6] =~ /\S/ )
    {
        my $Value = $Fields[6];
        $Value =~ s/[^\d+\-.]//g;
        if ( $Value =~ /\d/ ) {
            $Ob-&gt;{AT} = ( $Value - 32 ) * 5 / 9;
        }
    }
    if ( defined( $Fields[7] )
        &amp;&amp; $Fields[7] =~ /\S/ )
    {
        my $Value = $Fields[7];
        $Value =~ s/[^\d+\-.]//g;
        if ( $Value =~ /\d/ ) {
            $Ob-&gt;{WBT} = ( $Value - 32 ) * 5 / 9;
        }
    }

    # Winds converted from compass dir and Beaufort force
    if ( defined( $Fields[9] ) ) {
        my $Value = $Fields[9];
        $Value =~ s/&quot;//g;
        if ( $Value =~ /\S/ ) {
            my $Compass;
            my $Beaufort;
            if ( $Value =~ /(.*),\s*(\d.*)/ ) {
                $Compass  = $1;
                $Beaufort = $2;
            }
            else {
                $Compass = $Value;
            }
            $Compass = lc($Compass);
            $Ob-&gt;{D} = compass_to_degrees($Compass);    # Wind direction
            if ( defined( $Ob-&gt;{D} ) ) {
                $Ob-&gt;{DI} = 1;    # Winds on 32 point compass
            }
            if ( defined($Beaufort) ) {    # Wind speed
                if ( $Beaufort =~ /(\d+)-(\d+)/ ) {  # range of Beaufort numbers
                    $Ob-&gt;{W} =
                      ( beaufort_to_mps($1) + beaufort_to_mps($2) ) / 2;
                }
                else {
                    $Ob-&gt;{W} = beaufort_to_mps($Beaufort);
                }
                if ( defined( $Ob-&gt;{W} ) ) {
                    $Ob-&gt;{WI} = 5;                   # Beaufort wind force
                }
            }
        }
    }

    # Fill in extra metadata
    $Ob-&gt;{IM}   = 0;             # Check with Scott
    $Ob-&gt;{ATTC} = 2;             # icoads and supplemental
    $Ob-&gt;{TI}   = 0;             # Nearest hour time precision
    $Ob-&gt;{DS}   = undef;         # Unknown course
    $Ob-&gt;{VS}   = 0;             # Frozen in
    $Ob-&gt;{NID}  = 3;             # Check with Scott
    $Ob-&gt;{II}   = 10;            # Check with Scott
    $Ob-&gt;{ID}   = &#39;Discovery&#39;;
    $Ob-&gt;{C1}   = &#39;03&#39;;          # UK recruited
    if (   defined( $Ob-&gt;{AT} )
        || defined( $Ob-&gt;{WBT} )
        || defined( $Ob-&gt;{DPT} )
        || defined( $Ob-&gt;{SST} ) )
    {
        $Ob-&gt;{IT} = 4;           # Temps in degF and 10ths
    }

    # Add the icoads attachment
    push @{ $Ob-&gt;{attachments} }, 1;
    $Ob-&gt;{BSI} = undef;
    $Ob-&gt;{B10} = undef;          # 10 degree box
    $Ob-&gt;{B1}  = undef;          # 1 degree box
    $Ob-&gt;{DCK} = 246;            # Deck ID - from Scott
    $Ob-&gt;{SID} = 127;            # Source ID - from Scott
    $Ob-&gt;{PT}  = 9;              # &#39;ship overwintering in ice&#39;
    foreach my $Var (qw(DUPS DUPC TC PB WX SX C2)) {
        $Ob-&gt;{$Var} = undef;
    }

    # Other elements all missing
    foreach my $Var ( @{ $IMMA::parameters[1] } ) {
        unless ( exists( $Ob-&gt;{$Var} ) ) {
            $Ob-&gt;{$Var} = undef;
        }
    }

    # Add the original data as a supplemental attachment
    push @{ $Ob-&gt;{attachments} }, 99;
    $Ob-&gt;{ATTE} = undef;
    $Ob-&gt;{SUPD} = &quot;&quot;;

    # Year &amp; Month
    if ( defined( $Fields[0] ) &amp;&amp; $Fields[0] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot;%12s&quot;, $Fields[0];
    }
    else { $Ob-&gt;{SUPD} .= &quot;            &quot;; }

    # Day
    if ( defined( $Fields[1] ) &amp;&amp; $Fields[1] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %2d&quot;, $Fields[1];
    }
    else { $Ob-&gt;{SUPD} .= &quot;   &quot;; }

    # Hour
    if ( defined( $Fields[2] ) &amp;&amp; $Fields[2] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %2d&quot;, $Fields[2];
    }
    else { $Ob-&gt;{SUPD} .= &quot;   &quot;; }

    # Pressure
    if ( defined( $Fields[3] ) &amp;&amp; $Fields[3] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %6s&quot;, $Fields[3];
    }
    else { $Ob-&gt;{SUPD} .= &quot;       &quot;; }

    # Cape Armitage
    if ( defined( $Fields[4] ) &amp;&amp; $Fields[4] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %5s&quot;, $Fields[4];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }

    # Temperatures
    if ( defined( $Fields[5] ) &amp;&amp; $Fields[5] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %5s&quot;, $Fields[5];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }
    if ( defined( $Fields[6] ) &amp;&amp; $Fields[6] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %5s&quot;, $Fields[6];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }
    if ( defined( $Fields[7] ) &amp;&amp; $Fields[7] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %5s&quot;, $Fields[7];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }
    if ( defined( $Fields[8] ) &amp;&amp; $Fields[8] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %4s&quot;, $Fields[8];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }

    # Wind force and direction
    if ( defined( $Fields[9] ) &amp;&amp; $Fields[9] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %-13s&quot;, $Fields[9];
    }
    else { $Ob-&gt;{SUPD} .= &quot;              &quot;; }

    # Annemometer
    if ( defined( $Fields[10] ) &amp;&amp; $Fields[10] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %3s&quot;, $Fields[10];
    }
    else { $Ob-&gt;{SUPD} .= &quot;    &quot;; }

    # P. Tube
    if ( defined( $Fields[11] ) &amp;&amp; $Fields[11] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %5s&quot;, $Fields[11];
    }
    else { $Ob-&gt;{SUPD} .= &quot;      &quot;; }

    # Weather
    if ( defined( $Fields[12] ) &amp;&amp; $Fields[12] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %-35s&quot;, $Fields[12];
    }
    else { $Ob-&gt;{SUPD} .= &quot;                                    &quot;; }

    # Sunshine field is always blank
    # Clouds Upper
    if ( defined( $Fields[14] ) &amp;&amp; $Fields[14] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %-26s&quot;, $Fields[14];
    }
    else { $Ob-&gt;{SUPD} .= &quot;                           &quot;; }

    # Clouds Lower
    if ( defined( $Fields[15] ) &amp;&amp; $Fields[15] =~ /\S/ ) {
        $Ob-&gt;{SUPD} .= sprintf &quot; %-26s&quot;, $Fields[15];
    }
    else { $Ob-&gt;{SUPD} .= &quot;                           &quot;; }

    # Aspirator is always blank
    # Remarks
    $Fields[17] =~ s/\n//g;
    if ( defined( $Fields[17] ) ) { $Ob-&gt;{SUPD} .= &quot; &quot; . $Fields[17]; }

    # Output the IMMA ob
    $Ob-&gt;write( \*STDOUT );
}

# Bonvert Beaufort force to speed im m/a
sub beaufort_to_mps {
    my $Beau = shift;
    unless ( defined($Beau) &amp;&amp; $Beau =~ /\d/ &amp;&amp; $Beau &gt;= 0 &amp;&amp; $Beau &lt;= 12 ) {
        return;
    }
    return (qw(0 0.8 2.4 4.3 6.7 9.3 12.3 15.5 18.9 22.6 26.4 30.5 32.7))
      [$Beau];
}

# Convert 32-point compass direction to direction in degrees
sub compass_to_degrees {
    my $Dir_c = shift;
    $Dir_c =~ s/\s+//g;
    if ( lc($Dir_c) =~ /^c/ ) { $Dir_c = &#39;c&#39;; }
    if ( lc($Dir_c) =~ /^v/ ) { $Dir_c = &#39;v&#39;; }
    my %Directions = (
        n    =&gt; 360,
        nxe  =&gt; 11,
        nne  =&gt; 23,
        nexn =&gt; 34,
        ne   =&gt; 45,
        nexe =&gt; 57,
        ene  =&gt; 68,
        exn  =&gt; 79,
        e    =&gt; 90,
        exs  =&gt; 102,
        ese  =&gt; 113,
        sexe =&gt; 124,
        se   =&gt; 135,
        sexs =&gt; 147,
        sse  =&gt; 158,
        sxe  =&gt; 169,
        s    =&gt; 180,
        sxw  =&gt; 192,
        ssw  =&gt; 203,
        swxs =&gt; 214,
        sw   =&gt; 225,
        swxw =&gt; 237,
        wsw  =&gt; 248,
        wxs  =&gt; 259,
        w    =&gt; 270,
        wxn  =&gt; 282,
        wnw  =&gt; 293,
        nwxw =&gt; 304,
        nw   =&gt; 315,
        nwxn =&gt; 326,
        nnw  =&gt; 337,
        nxw  =&gt; 349,
        c    =&gt; 361,    # Calm
        v    =&gt; 362     # Variable
    );
    unless ( defined($Dir_c) ) { return undef; }
    $Dir_c =~ s/\W//g;
    if ( exists( $Directions{ lc($Dir_c) } ) ) {
        return $Directions{ lc($Dir_c) };
    }
    else {
        return undef;
    }
}

# Correct the date to UTC from local time
sub correct_hour_for_lon {
    my @Days_in_month = ( 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 );
    my $Ob            = shift;
    unless ( defined( $Ob-&gt;{LON} )
        &amp;&amp; defined( $Ob-&gt;{HR} )
        &amp;&amp; defined( $Ob-&gt;{DY} )
        &amp;&amp; defined( $Ob-&gt;{MO} )
        &amp;&amp; defined( $Ob-&gt;{YR} ) )
    {
        $Ob-&gt;{HR} = undef;
        return;
    }
    if ( $Ob-&gt;{YR} % 4 == 0
        &amp;&amp; ( $Ob-&gt;{YR} % 100 != 0 || $Ob-&gt;{YR} % 400 == 0 ) )
    {
        $Days_in_month[1] = 29;
    }
    $Ob-&gt;{HR} += $Ob-&gt;{LON} * 12 / 180;
    if ( $Ob-&gt;{HR} &lt; 0 ) {
        $Ob-&gt;{HR} += 24;
        $Ob-&gt;{DY}--;
        if ( $Ob-&gt;{DY} &lt; 0 ) {
            $Ob-&gt;{MO}--;
            if ( $Ob-&gt;{MO} &lt; 1 ) {
                $Ob-&gt;{YR}--;
                $Ob-&gt;{MO} = 12;
            }
            $Ob-&gt;{DY} = $Days_in_month[ $Ob-&gt;{MO} - 1 ];
        }
    }
    if ( $Ob-&gt;{HR} &gt; 23.99 ) {
        $Ob-&gt;{HR} -= 24;
        if ( $Ob-&gt;{HR} &lt; 0 ) { $Ob-&gt;{HR} = 0; }
        $Ob-&gt;{DY}++;
        if ( $Ob-&gt;{DY} &gt; $Days_in_month[ $Ob-&gt;{MO} - 1 ] ) {
            $Ob-&gt;{DY} = 1;
            $Ob-&gt;{MO}++;
            if ( $Ob-&gt;{MO} &gt; 12 ) {
                $Ob-&gt;{YR}++;
                $Ob-&gt;{MO} = 1;
            }
        }
    }
    return 1;
}
</pre></div>
</div>
</div>
<div class="section" id="converted-observations">
<h2>Converted observations<a class="headerlink" href="#converted-observations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/oldweather/Expeditions/blob/master/imma/Discovery_1901-4.imma">IMMA format</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Scotia_1902-4.html" title="Scotia (1902-4)"
             >next</a></li>
        <li class="right" >
          <a href="Southern_Cross_1897-1900.html" title="Southern Cross (1897-1900)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Expeditions</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Antarctic.html" >Antarctic Expeditions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>